<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Mongrel::URIClassifier</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Mongrel::URIClassifier</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/mongrel_rb.html">
                lib/mongrel.rb
                </a>
        <br />
                <a href="../../files/ext/http11/http11_c.html">
                ext/http11/http11.c
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000088">inspect</a>&nbsp;&nbsp;
      <a href="#M000089">new</a>&nbsp;&nbsp;
      <a href="#M000090">register</a>&nbsp;&nbsp;
      <a href="#M000092">resolve</a>&nbsp;&nbsp;
      <a href="#M000091">unregister</a>&nbsp;&nbsp;
      <a href="#M000087">uris</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">handler_map</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000089" class="method-detail">
        <a name="M000089"></a>

        <div class="method-heading">
          <a href="URIClassifier.src/M000089.html" target="Code" class="method-signature"
            onclick="popupCode('URIClassifier.src/M000089.html');return false;">
          <span class="method-name">URIClassifier.new &rarr; URIClassifier<br />
</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Initializes a new <a href="URIClassifier.html">URIClassifier</a> object
that you can use to associate URI sequences with objects. You can actually
use it with any string sequence and any objects, but it&#8217;s mostly used
with URIs.
</p>
<p>
It uses TST from <a
href="http://www.octavian.org/cs/software.html">www.octavian.org/cs/software.html</a>
to build an ternary search trie to hold all of the URIs. It uses this to do
an initial search for the a URI prefix, and then to break the URI into
SCRIPT_NAME and PATH_INFO portions. It actually will do two searches most
of the time in order to find the right handler for the registered prefix
portion.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000088" class="method-detail">
        <a name="M000088"></a>

        <div class="method-heading">
          <a href="URIClassifier.src/M000088.html" target="Code" class="method-signature"
            onclick="popupCode('URIClassifier.src/M000088.html');return false;">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Simply does an inspect that looks like a Hash inspect.
</p>
        </div>
      </div>

      <div id="method-M000090" class="method-detail">
        <a name="M000090"></a>

        <div class="method-heading">
          <a href="URIClassifier.src/M000090.html" target="Code" class="method-signature"
            onclick="popupCode('URIClassifier.src/M000090.html');return false;">
          <span class="method-name">uc.register("/someuri", SampleHandler.new) &rarr; nil<br />
</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers the SampleHandler (one for all requests) with the
&quot;/someuri&quot;. When URIClassifier::resolve is called with
&quot;/someuri&quot; it&#8217;ll return SampleHandler immediately. When
called with &quot;/someuri/iwant&quot; it&#8217;ll also return SomeHandler
immediatly, with no additional searches, but it will return path info with
&quot;/iwant&quot;.
</p>
<p>
You actually can reuse this class to register nearly anything and quickly
resolve it. This could be used for caching, fast mapping, etc. The downside
is it uses much more memory than a Hash, but it can be a lot faster.
It&#8217;s main advantage is that it works on prefixes, which is damn hard
to get right with a Hash.
</p>
        </div>
      </div>

      <div id="method-M000092" class="method-detail">
        <a name="M000092"></a>

        <div class="method-heading">
          <a href="URIClassifier.src/M000092.html" target="Code" class="method-signature"
            onclick="popupCode('URIClassifier.src/M000092.html');return false;">
          <span class="method-name">uc.resolve("/someuri") &rarr; "/someuri", "", handler<br />
uc.resolve("/someuri/pathinfo") &rarr; "/someuri", "/pathinfo", handler<br />
uc.resolve("/notfound/orhere") &rarr; nil, nil, nil<br />
uc.resolve("/") &rarr; "/", "/", handler  # if uc.register("/", handler)<br />
uc.resolve("/path/from/root") &rarr; "/", "/path/from/root", handler  # if uc.register("/", handler) <br />
</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Attempts to resolve either the whole URI or at the longest prefix,
returning the prefix (as script_info), path (as path_info), and registered
handler (usually an <a href="HttpHandler.html">HttpHandler</a>). If it
doesn&#8217;t find a handler registered at the longest match then it
returns nil,nil,nil.
</p>
<p>
Because the resolver uses a trie you are able to register a handler at
<b>any</b> character in the URI and it will be handled as long as
it&#8217;s the longest prefix. So, if you registered handler 1 at
&quot;/something/lik&quot;, and 2 at &quot;/something/like/that&quot;, then
a a search for &quot;/something/like&quot; would give you 1. A search for
&quot;/something/like/that/too&quot; would give you 2.
</p>
<p>
This is very powerful since it means you can also attach handlers to parts
of the ; (semi-colon) separated path params, any part of the path, use off
chars, anything really. It also means that it&#8217;s very efficient to do
this only taking as long as the URI has characters.
</p>
<p>
A slight modification to the CGI 1.2 standard is given for handlers
registered to &quot;/&quot;. CGI expects all CGI scripts to be at some
script path, so it doesn&#8217;t really say anything about a script that
handles the root. To make this work, the resolver will detect that the
requested handler is at &quot;/&quot;, and return that for script_name, and
then simply return the full URI back as path_info.
</p>
<p>
It expects strings with no embedded &#8217;\0&#8217; characters.
Don&#8216;t try other string-like stuff yet.
</p>
        </div>
      </div>

      <div id="method-M000091" class="method-detail">
        <a name="M000091"></a>

        <div class="method-heading">
          <a href="URIClassifier.src/M000091.html" target="Code" class="method-signature"
            onclick="popupCode('URIClassifier.src/M000091.html');return false;">
          <span class="method-name">uc.unregister("/someuri")<br />
</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Yep, just removes this uri and it&#8217;s handler from the trie.
</p>
        </div>
      </div>

      <div id="method-M000087" class="method-detail">
        <a name="M000087"></a>

        <div class="method-heading">
          <a href="URIClassifier.src/M000087.html" target="Code" class="method-signature"
            onclick="popupCode('URIClassifier.src/M000087.html');return false;">
          <span class="method-name">uris</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the URIs that have been registered with this classifier so far. The
URIs returned should not be modified as this will cause a memory leak. You
can use this to inspect the contents of the <a
href="URIClassifier.html">URIClassifier</a>.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>